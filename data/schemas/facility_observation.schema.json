{
  "_metadata": {
    "file_id": "SOM-DTA-0001-v0.1.0",
    "name": "facility_observation.schema.json",
    "description": "JSON Schema for on-site / remote observations used to assess real-world operational status of licensed healthcare facilities (separate from official license data).",
    "project_id": "HIPPOCRATIC",
    "category": "data/schemas",
    "tags": ["schema", "observations", "checklist", "facilities", "verification"],
    "created": "2026-01-16",
    "modified": "2026-01-16",
    "version": "0.1.0",
    "agent": {
      "id": "AGENT-CURSOR-OPENAI",
      "name": "cursor_agent",
      "model": "gpt-5.2"
    },
    "execution": {
      "type": "schema",
      "invocation": "Validate observation JSON documents recorded by the webapp"
    }
  },
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://somacosf.local/schemas/facility_observation.schema.json",
  "title": "FacilityObservation",
  "type": "object",
  "additionalProperties": false,
  "required": ["observationId", "state", "facilityId", "observedAt", "checklistVersion", "assessment", "evidence"],
  "properties": {
    "observationId": {
      "type": "string",
      "description": "Client-generated unique id (uuid recommended)."
    },
    "state": {
      "type": "string",
      "minLength": 2,
      "maxLength": 2,
      "description": "US state code (e.g. CA)."
    },
    "facilityId": {
      "type": "string",
      "description": "Facility identifier from the official dataset (CA: FACID)."
    },
    "observedAt": {
      "type": "string",
      "format": "date-time",
      "description": "When the observation was made."
    },
    "observer": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "observerId": { "type": "string" },
        "role": { "type": "string", "description": "e.g. volunteer, auditor, staff" },
        "contact": { "type": "string", "description": "Optional contact handle/email" }
      }
    },
    "checklistVersion": {
      "type": "string",
      "description": "Version string for the checklist/questionset used to collect this observation."
    },
    "context": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "source": {
          "type": "string",
          "enum": ["street_view", "on_site", "phone_call", "web_review", "other"],
          "description": "Primary observation source."
        },
        "lat": { "type": "number" },
        "lng": { "type": "number" },
        "addressText": { "type": "string" }
      }
    },
    "assessment": {
      "type": "object",
      "additionalProperties": false,
      "required": ["operationalStatus", "confidence"],
      "properties": {
        "operationalStatus": {
          "type": "string",
          "enum": ["operational", "likely_operational", "uncertain", "likely_closed", "closed"],
          "description": "Observer's real-world operational assessment (not the license status)."
        },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Confidence in operationalStatus (0-1)."
        },
        "signals": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "exterior": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "signagePresent": { "$ref": "#/$defs/ynu" },
                "buildingAccessible": { "$ref": "#/$defs/ynu" },
                "windowsBoarded": { "$ref": "#/$defs/ynu" },
                "visibleDamage": { "$ref": "#/$defs/ynu" },
                "constructionOngoing": { "$ref": "#/$defs/ynu" }
              }
            },
            "entry": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "doorLocked": { "$ref": "#/$defs/ynu" },
                "doorbellOrIntercomPresent": { "$ref": "#/$defs/ynu" },
                "postedHoursPresent": { "$ref": "#/$defs/ynu" }
              }
            },
            "activity": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "staffObserved": { "$ref": "#/$defs/ynu" },
                "patientsObserved": { "$ref": "#/$defs/ynu" },
                "childrenObserved": { "$ref": "#/$defs/ynu" },
                "phonesAnswered": { "$ref": "#/$defs/ynu" }
              }
            }
          }
        },
        "notes": {
          "type": "string",
          "description": "Freeform notes (keep short; add links/photos as evidence)."
        }
      }
    },
    "evidence": {
      "type": "array",
      "minItems": 0,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["type"],
        "properties": {
          "type": {
            "type": "string",
            "enum": ["street_view", "photo", "video", "website", "phone_log", "other"]
          },
          "url": { "type": "string" },
          "capturedAt": { "type": "string", "format": "date-time" },
          "notes": { "type": "string" }
        }
      }
    }
  },
  "$defs": {
    "ynu": {
      "type": "string",
      "enum": ["yes", "no", "unknown"]
    }
  }
}





